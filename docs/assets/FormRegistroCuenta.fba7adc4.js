import{Q as J}from"./QBtnToggle.bfaab28d.js";import{r as I,c as m,ag as y,aK as h,aq as n,aj as l,ai as r,aM as S,aN as U,bI as M,bJ as Y,z as B,ap as E,ah as K,b5 as H,b6 as W,aO as X,j as Z,f as A,I as ee,Q as x,E as te}from"./index.20d4ad85.js";import{a as ae,Q as oe}from"./useNotificacion.79136029.js";import{C as le}from"./index.804869e1.js";import{_ as ne}from"./CuentaContableSelect.d4102a6d.js";import{Q as F}from"./QImg.df9e647c.js";import{Q as R}from"./QItemLabel.be9194dc.js";import{Q as k,a as Q}from"./QList.5cb48b53.js";import{Q as ie,l as ue,D as re}from"./DialogTitle.a45c2883.js";import{r as se}from"./index.27a31e1c.js";import{c as de,L as ce,b as pe}from"./useCuentasCrud.5ef3cef5.js";const me={class:"row q-gutter-x-sm"},fe={class:"col"},ve={key:0,class:"q-mt-xs",style:{border:"0px solid red"}},be={__name:"BancoSelect",props:{modelValue:{type:Object,required:!1,default:()=>null},opcional:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"Seleccionar Banco"},hint:{type:String,required:!1,default:""},agregar:{type:Boolean,required:!1,default:!1},readonly:{type:Boolean,required:!1,default:!1},isValid:{type:Boolean,required:!1,default:!0},rules:{type:Array,required:!1,default:()=>[]}},emits:["update:modelValue"],setup(f,{emit:V}){const g=de(),s=I([]),c=I(!1),C=f,w=V,q=m({get(){return C.modelValue},set(v){w("update:modelValue",v)}});function d(v,p){if(v===""){p(()=>{s.value=g.listaBancos});return}p(()=>{const i=v.toLowerCase();s.value=g.listaBancos.filter(e=>e.nombre.toLowerCase().indexOf(i)>-1)})}function N(){c.value=!0}return(v,p)=>(y(),h(X,null,[n("div",me,[n("div",fe,[l(ie,{outlined:"",color:"secondary",modelValue:q.value,"onUpdate:modelValue":p[0]||(p[0]=i=>q.value=i),options:s.value,"option-label":"nombre",label:C.label,"use-input":"","input-debounce":"0",onFilter:d,behavior:"menu",clearable:"",rules:C.rules,lazyRules:"",dense:"",hint:C.hint,readonly:f.readonly},{"selected-item":r(i=>[l(F,{class:"q-mx-md",src:`/icons/${i.opt.icono}`,width:"20px",height:"20px"},null,8,["src"]),l(R,null,{default:r(()=>[S(U(i.opt.nombre),1)]),_:2},1024)]),option:r(i=>[l(k,M(Y(i.itemProps)),{default:r(()=>[l(Q,{avatar:""},{default:r(()=>[l(F,{src:`/icons/${i.opt.icono}`,width:"30px",height:"30px"},null,8,["src"])]),_:2},1024),l(Q,null,{default:r(()=>[l(R,null,{default:r(()=>[S(U(i.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[l(k,null,{default:r(()=>[l(Q,{class:"text-grey"},{default:r(()=>[S(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","rules","hint","readonly"])]),f.agregar?(y(),h("div",ve,[l(B,{color:"accent",outline:"",icon:"add",dense:"",onClick:N})])):E("",!0)]),(y(),K(W,{to:"#modal"},[l(H,{modelValue:c.value,"onUpdate:modelValue":p[1]||(p[1]=i=>c.value=i),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:r(()=>[l(we)]),_:1},8,["modelValue"])]))],64))}},ge=Z("tipoCuentaStore",()=>{const f=I([]),V=A({fetchPolicy:"no-cache"}),{onResult:g,onError:s}=se(ce,null,V);return g(({data:c})=>{console.dir(c),f.value=JSON.parse(JSON.stringify(c.listaTiposCuenta))}),s(c=>{ue(c)}),{listaTiposCuenta:f}});const Ce={class:"my-card",style:{width:"500px"}},_e={class:"q-pa-lg"},ye={class:"q-gutter-xs"},Ve={class:"q-my-md"},qe={class:"column items-center"},xe={class:"q-gutter-xs q-mt-xs",style:{width:"85%",border:"0px solid red"}},he={key:0},Ne={class:"q-pb-lg"},Se={key:1,class:"row q-gutter-x-md"},Ie={class:"col"},Qe={class:"col"},Ue={class:""},Be=n("div",{class:"column"},[n("div",{class:""})],-1),Ee={class:"col row justify-end q-pt-lg q-gutter-lg"},we={__name:"FormRegistroCuenta",props:{editedItem:{type:Object,required:!1,default:()=>({id:null})}},emits:["cuentaSaved","cuentaUpdated"],setup(f,{emit:V}){const g=ge(),s=pe(),{mostrarNotificacionPositiva:c,mostrarNotificacionNegativa:C,mostrarNotificacionInformativa:w}=ae(),q=I({nombre:"",identificador:"",cuentaContable:null,tipoCuenta:{id:"1"}}),d=A({subnivel:0,tipoAfectacion:"C",clasificacion:""});s.onDoneCuentaCreate(({data:o})=>{if(console.log("saved data...",o),o){const a=o.cuentaCreate.cuenta;N("guard\xF3",a),p("cuentaSaved",a)}}),s.onDoneCuentaUpdate(({data:o})=>{if(o){console.log("updated data...",o);const a=o.cuentaUpdate.cuenta;N("actualiz\xF3",a),p("cuentaUpdated",a)}});function N(o,a){c(`La cuenta "${a.nombre}" se ${o} correctamente`,2500)}const v=f,p=V,i=m({get(){var o,a;return e.value.tipoCuenta.id==="3"?(o=g.listaTiposCuenta.filter(t=>t.id===e.value.tipoCuenta.id))!=null?o:[]:(a=g.listaTiposCuenta.filter(t=>t.id!="3"))!=null?a:[]}}),e=m({get(){return v.editedItem?v.editedItem:q.value},set(o){q.value=o}}),D=m({get(){return e.value.id?"Actualizar la Cuenta":e.value.tipoCuenta.id==="3"?"Nueva tarjeta de cr\xE9dito":"Nueva Cuenta"}});m({get(){return e.value.tipoCuenta.id?e.value.tipoCuenta.id==="3"?"Nombre de la tarjeta:":"Nombre de la cuenta:":""}});const L=m({get(){return e.value.id?"Actualizar":"Guardar"}}),j=m({get(){return e.value.tipoCuenta.id==="3"}}),O=m({get(){return e.value.tipoCuenta.id!=="2"}}),P=m({get(){return!!e.value.id}});ee(()=>{z(e.value.tipoCuenta.id.toString())});function $(){console.log("save item",e.value);const o=e.value.tipoCuenta.id,a=e.value.banco?e.value.banco.id:void 0,t=e.value.identificador?e.value.identificador:"",_=e.value.diasGracia?parseInt(e.value.diasGracia):0;let b=null;e.value.cuentaContable&&(b=parseInt(e.value.cuentaContable.id));const u={...e.value,identificador:t,cuentaContableId:parseInt(b),cuentaContable:void 0,tipoCuentaId:parseInt(o),bancoId:a,diaCorte:parseInt(e.value.diaCorte),diasGracia:_,banco:void 0,tipoCuenta:void 0,__typename:void 0};if(!e.value.id)console.log("guardando cuenta nueva",u),u.saldo=parseFloat(0),s.cuentaCreate({input:u});else{o==="2"&&(console.log("se cambio el tipo de cuenta",o),u.bancoId=null,u.diaCorte=null,u.identificador=null);const T=e.value.id;console.log("actualizando cuenta",T,u),s.cuentaUpdate({id:T,input:u})}}s.onErrorCuentaCreate(o=>{var _,b,u;const t=((u=(b=(_=o.graphQLErrors[0])==null?void 0:_.extensions)==null?void 0:b.nombre)!=null?u:null)?"No fue posible guardar la cuenta. Ya existe una cuenta con el nombre que intenta guardar":"No fue posible guardar la cuenta. Favor de intentar nuevamente";C(t,2100)}),s.onErrorCuentaUpdate(o=>{var _,b,u;const t=((u=(b=(_=o.graphQLErrors[0])==null?void 0:_.extensions)==null?void 0:b.nombre)!=null?u:null)?"No fue posible actualizar la cuenta. Ya existe una cuenta con el nombre que intenta guardar":"No fue posible actualizar la cuenta. Favor de intentar nuevamente";C(t,2100)});function G(o){z(o)}function z(o){switch(console.log("tipo de cuenta actualizado",o),o){case"1":d.tipoAfectacion="C",d.clasificacion="112";break;case"2":d.tipoAfectacion="C",d.clasificacion="11100";break;case"3":d.tipoAfectacion="A",d.clasificacion="212";break}}return(o,a)=>(y(),h("div",Ce,[l(re,null,{default:r(()=>[S(U(D.value),1)]),_:1}),n("div",_e,[l(oe,{onSubmit:$,class:"q-gutter-lg"},{default:r(()=>[n("div",ye,[n("div",Ve,[l(J,{modelValue:e.value.tipoCuenta.id,"onUpdate:modelValue":[a[0]||(a[0]=t=>e.value.tipoCuenta.id=t),G],spread:"","no-caps":"",color:"disable-button","text-color":"gray-2","toggle-color":"toggle-button","toggle-text-color":"accent-light",options:i.value,push:"",disable:P.value},null,8,["modelValue","options","disable"])]),n("div",qe,[n("div",xe,[n("div",null,[l(x,{modelValue:e.value.nombre,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.nombre=t),type:"text",label:"Nombre de la cuenta",dense:"",outlined:"",color:"positive",autofocus:"","lazy-rules":"",rules:[t=>t&&t.length>0||"Requerido"]},null,8,["modelValue","rules"])]),O.value?(y(),h("div",he,[n("div",null,[l(be,{modelValue:e.value.banco,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.banco=t),label:"Banco",rules:[t=>!!t||"Favor de ingresar el banco"]},null,8,["modelValue","rules"])]),l(x,{modelValue:e.value.identificador,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.identificador=t),type:"text",label:"Terminaci\xF3n del n\xFAmero de cuenta",outlined:"",color:"positive",dense:"",rules:[t=>!!t&&t.length==4||"Favor de ingresar los \xFAltimos 4 d\xEDgitos de la cuenta"],mask:"####"},null,8,["modelValue","rules"])])):E("",!0),n("div",Ne,[l(x,{modelValue:e.value.propietario,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.propietario=t),type:"text",label:"Nombre Propietario",outlined:"",dense:""},null,8,["modelValue"])]),j.value?(y(),h("div",Se,[n("div",Ie,[l(x,{modelValue:e.value.diaCorte,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.diaCorte=t),outlined:"",label:"D\xEDa de corte",type:"number",dense:"","lazy-rules":"",rules:[t=>!!t&&t>0&&t<=30||"Requerido (Entre 0 y 30)"]},null,8,["modelValue","rules"])]),n("div",Qe,[l(x,{modelValue:e.value.diasGracia,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.diasGracia=t),outlined:"",label:"D\xEDas de gracia",type:"number",dense:"","lazy-rules":"",rules:[t=>!!t&&t>0&&t<=30||"Requerido (Entre 0 y 30)"]},null,8,["modelValue","rules"])])])):E("",!0),n("div",Ue,[l(ne,{modelValue:e.value.cuentaContable,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.cuentaContable=t),subnivel:d.subnivel,clasificacion:d.clasificacion,"tipo-afectacion":d.tipoAfectacion,"is-alta":!1,"input-label":"Seleccione una Cuenta Contable",rules:[t=>!!t||"Requerido"]},null,8,["modelValue","subnivel","clasificacion","tipo-afectacion","rules"])]),Be])]),n("div",Ee,[te(l(B,{label:"Cancelar",color:"negative",flat:"",class:"q-ml-sm","no-caps":"",rounded:""},null,512),[[le]]),l(B,{label:L.value,type:"submit","no-caps":"",color:"primary-button"},null,8,["label"])])])]),_:1})])]))}};export{we as _};
