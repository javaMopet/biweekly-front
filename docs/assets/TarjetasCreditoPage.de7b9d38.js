import{Q as P,a as x}from"./QBreadcrumbs.fcd8d044.js";import{Q as z,a as F}from"./index.804869e1.js";import{af as M,r as d,I as O,ag as y,aK as A,aj as a,ai as n,aq as t,u as j,ah as K,b5 as G,b6 as H,z as f,Q as J,ao as k,aN as u}from"./index.20d4ad85.js";import{Q as W}from"./QSpinnerBall.7159b7fa.js";import{Q as X}from"./QInnerLoading.1824423b.js";import{Q}from"./QImg.df9e647c.js";import{u as Y,b as Z,a as ee}from"./useCuentasCrud.5ef3cef5.js";import{_ as te}from"./FormRegistroCuenta.fba7adc4.js";import{u as oe,a as $}from"./useNotificacion.79136029.js";import{u as ae}from"./useFormato.c7e3ed92.js";import{u as ie}from"./useRegistrosTarjetaCrud.e130dd85.js";import"./format.9422eb17.js";import"./index.27a31e1c.js";import"./QList.5cb48b53.js";import"./DialogTitle.a45c2883.js";import"./QItemLabel.be9194dc.js";import"./printer.c268160e.js";import"./QBtnToggle.bfaab28d.js";import"./CuentaContableSelect.d4102a6d.js";const ne={class:""},se={class:"row items-center q-ml-sm q-gutter-x-sm"},le={class:"q-pa-md q-gutter-sm"},re={class:"column q-mx-md"},ce={class:"row fit"},de=t("div",{class:"page-title"},"Tarjetas de cr\xE9dito",-1),ue={class:"row inline items-center q-gutter-x-md"},me={class:""},_e={class:"bg-accent-light"},pe={class:"credit-card q-ma-sm"},fe={class:"q-pa-sm"},ve={class:"row full-width items-center justify-between credit-card__title q-px-md"},be=["onClick"],he={class:"text-blue-10 text-bold"},ge={class:"text-subtitle2"},we=["onClick"],Ce={class:""},xe=["onClick"],ye={class:"row full-width justify-center",style:{cursor:"pointer"}},je=["onClick"],ke={class:"row justify-between items-center q-px-lg q-pb-sm"},Qe={class:"text-caption text-blue-grey-7"},$e={class:"row inline"},He={__name:"TarjetasCreditoPage",setup(qe){const q=oe(),v=$(),D=M(),b=Y(),h=ie(),m=Z(),{toCurrencyAbsoluteFormat:N}=ae(),{mostrarNotificacionPositiva:T,mostrarNotificacionNegativa:I}=$(),g=d([]);h.onDoneRegistroTarjetaDelete(({data:e})=>{if(e){refetchListaCuentas();const i=e.cuentaDelete.cuenta;L("elmin\xF3",i)}}),h.onErrorRegistroTarjetaDelete(e=>{console.error(e),v.mostrarNotificacionNegativa("No es posible eliminar esta tarjeta de cr\xE9dito debido a que tiene movimientos",1500)});const _={id:null,nombre:null,identificador:null,tipoCuenta:{id:null},cuentaContable:null},p=d(),s=d(!1),l=d({..._}),B=[{name:"nombre",label:"Nombre",field:"nombre",sortable:!0,align:"left"},{name:"descripcion",label:"Descripci\xF3n",field:"descripcion",sortable:!0,align:"left"},{name:"cuenta_contable",label:"Cuenta Contable",field:e=>`${e.cuentaContable.id} - ${e.cuentaContable.nombre}`,sortable:!0,align:"left"}];O(()=>{b.loadOrRefetchListaCuentas()});function S(e){console.log("tipo de cuenta",e),l.value={..._},l.value.tipoCuenta.id=e.toString(),s.value=!0}function R(e){l.value={...e.row},s.value=!0}function c(e){console.log("abriendo movimientos",e),g.value[e.rowIndex]=!0,D.push(`/tarjetas_credito/${e.row.id}`)}function V(e){q.dialog({title:"Confirmar",style:"width:500px",message:`Est\xE1 a punto de eliminar la cuenta "${e.row.nombre}" \xBFDesea continuar con la eliminaci\xF3n?`,ok:{push:!0,color:"positive",label:"Continuar"},cancel:{push:!0,color:"negative",flat:!0,label:"cancelar"},persistent:!0}).onOk(()=>{m.cuentaDelete({id:e.row.id})}).onCancel(()=>{}).onDismiss(()=>{})}m.onDoneCuentaDelete(({data:e})=>{console.log("tarjeta eliminada",e);const i=e.cuentaDelete.cuenta;T(`Se elimin\xF3 la tarjeta "${i.nombre}".`,2100)}),m.onErrorCuentaDelete(e=>{console.trace(e),I("No es posible eliminar la tarjeta",2100)});function E(e){console.log("tarjetaSaved",e),s.value=!1}function U(e){s.value=!1,l.value={..._}}function L(e,i){v.mostrarNotificacionPositiva(`La cuenta "${i.nombre}" se ${e} correctamente`,1500)}return(e,i)=>(y(),A("div",ne,[a(z,{class:"",dense:"",fit:""},{default:n(()=>[t("div",se,[t("div",le,[a(P,{class:"breadcrum-component","active-color":"primary",separator:">","separator-color":"primary"},{default:n(()=>[a(x,{icon:"home",to:"/"}),a(x,{label:"Tarjetas de Cr\xE9dito",icon:"account_balance",to:"/admin/cuentas"})]),_:1})])]),a(F)]),_:1}),t("div",re,[t("div",ce,[a(ee,{grid:"",style:{width:"100%"},dense:"",rows:j(b).listaCuentasTarjeta,columns:B,"row-key":"id",filter:p.value,"rows-per-page-options":[0],"hide-pagination":""},{"top-left":n(()=>[de]),"top-right":n(()=>[t("div",ue,[t("div",me,[a(f,{color:"primary-button",icon:"add_card",onClick:i[0]||(i[0]=o=>S(3)),label:"Nuevo","no-caps":"","text-color":"accent-light",push:""})]),t("div",_e,[a(J,{outlined:"",dense:"",debounce:"300",modelValue:p.value,"onUpdate:modelValue":i[1]||(i[1]=o=>p.value=o),placeholder:"Buscar"},{append:n(()=>[a(k,{name:"search"})]),_:1},8,["modelValue"])])])]),item:n(o=>{var w,C;return[t("div",pe,[t("div",fe,[a(X,{class:"card-loading",showing:g.value[o.rowIndex],style:{"border-radius":"20px"}},{default:n(()=>[a(W,{size:"90px",color:"white"})]),_:2},1032,["showing"]),t("div",ve,[t("div",{class:"text-bold text-subtitle1 q-py-sm",onClick:r=>c(o),style:{cursor:"pointer"}},u(o.row.nombre),9,be),t("div",he,[t("span",ge,u(j(N)(o.row.saldo)),1)])]),t("div",{class:"row full-width justify-between items-center credit-card__images",onClick:r=>c(o)},[t("div",Ce,[a(Q,{src:"/images/chip.png",width:"46px",height:"40px"})]),t("div",{class:"credit-card__images--logo",onClick:r=>c(o)},[a(Q,{src:`/icons/${(C=(w=o.row.banco)==null?void 0:w.icono)!=null?C:"cash.png"}`,width:"60px"},null,8,["src"])],8,xe)],8,we),t("div",ye,[t("div",{class:"non-selectable q-py-xs text-blue-grey-8 text-h6",onClick:r=>c(o)}," **** **** **** "+u(o.row.identificador),9,je)])]),t("div",ke,[t("span",Qe,u(o.row.propietario),1),t("div",$e,[a(f,{flat:"",round:"",icon:"las la-edit",class:"button-edit",color:"primary",onClick:r=>R(o)},null,8,["onClick"]),a(f,{flat:"",round:"",icon:"las la-trash-alt",class:"button-delete",color:"negative",onClick:r=>V(o)},null,8,["onClick"])])])])]}),"body-cell-icono":n(o=>[a(k,{name:o.row.icono,size:"35px",color:"cyan"},null,8,["name"])]),_:1},8,["rows","filter"])])]),(y(),K(H,{to:"#modal"},[a(G,{modelValue:s.value,"onUpdate:modelValue":i[2]||(i[2]=o=>s.value=o),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:n(()=>[a(te,{"edited-item":l.value,onCuentaSaved:E,onCuentaUpdated:U},null,8,["edited-item"])]),_:1},8,["modelValue"])]))]))}};export{He as default};
