import{j as k,r,P as u,k as l}from"./index.20d4ad85.js";const _=k("session",()=>{const s=r(null),n=r(null),i=()=>s.value,c=()=>{var e;return(e=n.value)==null?void 0:e.email},g=()=>{var e;return n.value=u.getItem("user")?u.getItem("user"):null,!!n.value&&!!n.value.id?(e=n.value)==null?void 0:e.id:null},d=()=>!(s.value==null||s.value==JSON.stringify(null)),v=e=>new Promise((o,a)=>{l.post("users",e).then(t=>{console.log("register response",t),U(t),o(t)}).catch(t=>{console.log(t.response.data.exception),a(t)})}),h=e=>new Promise((o,a)=>{l.post("users/sign_in/",e).then(t=>{console.log("response.data",t),m(t),o(t)}).catch(t=>{console.log(t),a(t)})}),f=()=>{const e={headers:{authorization:s}};return new Promise((o,a)=>{l.delete("/users/sign_out",e).then(t=>{I(),o(t)}).catch(t=>{a(t)})})};function m(e){e.data.message==="You are logged in."&&(n.value=e.data.user,s.value=e.headers.authorization,u.set("auth_token",s.value),u.set("user",n.value))}function U(e){e.data.status.code===200&&(n.value=e.data.status.data,u.set("user",n.value),s.value=e.headers.authorization,u.set("user",n.value))}function I(){console.log("resetting info"),n.value=null,s.value=null,u.remove("auth_token"),u.remove("user"),l.defaults.headers.common.Authorization=null}return{getUserEmail:c,getAuthToken:i,getUserId:g,isLoggetIn:d,registerUser:v,loginUser:h,logoutUser:f}});export{_ as u};
